<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CUE File to Tracklist Converter</title>
</head>
<body>
    <input type="file" id="cueFile" accept=".cue">
    <button onclick="convertToTracklist()">Convert</button>
    <pre id="output"></pre>

    <script>
        function convertToTracklist() {
            const fileInput = document.getElementById('cueFile');
            const output = document.getElementById('output');

            if (fileInput.files.length === 0) {
                alert('Please select a file first.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(event) {
                const fileContent = event.target.result;
                const lines = fileContent.split('\n');
                let result = [];
                let artist = '';
                let title = '';

                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line.startsWith('TITLE')) {
                        const parts = line.split('"');
                        if (parts.length > 1) {
                            title = parts[1];
                        }
                    } else if (line.startsWith('PERFORMER')) {
                        const parts = line.split('"');
                        if (parts.length > 1) {
                            artist = parts[1];
                        }

                        // Combine title and artist in the switched order
                        const fullEntry = artist + ' - ' + title;
                        if (!result.includes(fullEntry) && fullEntry !== ' - ') {
                            result.push(fullEntry);
                        }

                        // Reset title and artist for next iteration
                        title = '';
                        artist = '';
                    }
                }
                // Remove the first line if any and add numbering
                if (result.length > 1) {
                    result = result.slice(1); // Remove the first element
                }
                result = result.map((line, index) => (index + 1) + '. ' + line); // Add numbering
                output.textContent = result.join('\n');
            };
            reader.readAsText(fileInput.files[0]);
        }
    </script>
</body>
</html>
